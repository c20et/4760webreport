<!DOCTYPE html>
<html lang="en">

  <head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>3-DOF Self-stabilizing Quadcopter Frame or: How We Learned To Stop Trying and Not Build the Drone</title>

    <!-- Bootstrap core CSS -->
    <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom fonts for this template -->
    <link href="vendor/fontawesome-free/css/all.min.css" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet" type="text/css">
    <link href='https://fonts.googleapis.com/css?family=Kaushan+Script' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Droid+Serif:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Roboto+Slab:400,100,300,700' rel='stylesheet' type='text/css'>

    <!-- Custom styles for this template -->
    <link href="css/agency.css" rel="stylesheet">

  </head>

  <body id="page-top">

    <!-- Header -->
     <div class="pagehead">
      <div class="container">
        <h1>  </h1>
      </div>
    </div>

    <div class="container">
        <div class="row">
          <div class="col-lg-8 mx-auto">
            <div class="lab-page">
              <!-- Project Details Go Here -->
              
              <p class="item-intro text-muted"> Labhansh Aritwal la375 <br> Adrian Dohmann ahd59 <br> Kenneth Huaman kch95 <br> Vini Tripathii ut33</p>

              <h2> INTRODUCTION </h2>
              <p> We created a 3 rotational degree of freedom quadcopter frame. The result was so that when placed on the small surface area of roughly a finger tip, the quadcopter can maintain its stability and recover from perturbations. The four motors increase and decrease in speed according the size and direction of the disturbance so as to minimize the oscillations of the quadcopter frame. The original goal of this project was to create a drone that could hover, but due to safety constraints, we were unable to obtain the necessary control values for the height (the Z-axis) and pivoted to a quadcopter that could self-stabilize in pitch and roll. The main components of this project are the microcontroller (PIC32), ESC’s (electronic speed controllers), motors and two Android phones. One Android sensor acted as a Bluetooth remote and was mainly relevant during the tuning process, the second phone acted as a receiver and sensor. We used the Android sensor, compass orientation, to detect absolute angle orientation with respect to pitch, roll and yaw. (The compass orientation sensor is a software sensor that combines information from the geomagnetic field and accelerometer hardware sensor in the phone to computer the phone’s angle orientation.) The control algorithm used in this project was PID.
              </p>
              
              <h2> High Level Design </h2>
              <h3> Origin of Idea </h3>
              <p> It was something that Labhansh came up and we were really thrilled to hear the whole concept. It felt different and unique, and we didn’t know if it would work but we still wanted to do it because it was a fun experiment.
              </p>
              <p> Labhansh - “I came up with this idea 2 years back when I first heard about drones particularly quadcopters. Until then I never knew about them. It didn’t take me much time to find out how they work, specially the part where they use sensors like Accelerometer, Gyroscope, Camera etc etc. It was common knowledge at that time that even the new smartphones are coming with these sensors. So, it just struck me that why not use a phone on the drone. Why to take such a pain to integrate all the sensors when there is a centralized integrated solution in the market (Smartphone). And with that this idea was born”
              </p>
              <h3> Background Math </h3>
              <p> For this project, we worked with Euler Angles. The choice came down to this or using Quaternions to represent 3d rotations. We chose Euler Angles because of the familiarity and since the phone could precalculate absolute orientation with respect to Euler Angles.
              </p> 
              <p> The basic setup is a standard right- hand rule axis, with x lying parallel to the length of the vehicle and positive in a forward direction, y lying parallel to the width and positive to the right(assuming a top down, front first image), and the z axis facing directly down towards the earth. Pitch, Roll, and Yaw therefore correspond to right-hand curls along the y, x, and z axes respectively. This setup allows us to create parallels for the x- quadcopter to the single DOF motor from lab 4.
              </p> 
              <img class="img-fluid d-block mx-auto" width="250" height="70" src="./img/topviewdrone.jpg" alt="drone top view">
              <img class="img-fluid d-block mx-auto" width="250" height="70" src="./img/pitchrollyaw.jpg" alt="pitchrollyaw">
              <h6> Figure BM1: To the left can be seen an example of the euler angle scheme for a plane. To the right can be seen a top down view of our quadcopter with the arms labeled as mentioned</h6>
              <h3> Logical Structure </h3>
              <p> 
              </p> 
              <h3> Origin of Idea </h3>
              <h4> Remote Transmitter Smartphone </h4>
              <h4> Smartphone + Drone </h4>
              

              <h3> Acoustic Team </h3>
              <p> Priya and Vini worked on the acoustic functionalities. <br>
              Assembling the microphone circuit. </p>
              Materials Used:<br>
              &emsp; - 1 Arduino Uno <br>
              &emsp; - Electret microphone <br>
              &emsp; - 1 µF capacitor, 6.8µF capacitor <br>
              &emsp; - various resistors <br>
              &emsp; - LM358 Op Amp <br>
              &emsp; - Various wires <br>

              <img class="img-fluid d-block mx-auto" width="250" height="70" src="./img/lab2/acoustic/microphone schematic initial.png" alt="">
              <p> We first connected the microphone to the arduino using the diagram above as reference. We used a 3.24KΩ Resistor and a 1µF Capacitor. We connected the output to pin A1.<br>
              In Arduino the ADC clock is preset to 16 MHz/128 = 125 KHz (though the sampling rate can be increased). Each conversion in AVR takes 13 ADC clocks so so the equivalent frequency is 125 KHz /13 = 9615 Hz. The ‘start’ is signaled by 660Hz, so analogRead is sufficient to fulfill the Nyquist Criteria which requires that the sampling frequency is at least twice the highest frequency component to avoid aliasing. The frequency of the human speech 85-180 Hz for males and 165-255 for females, and so should not interfere with sensing the start signal. <br>
              We hooked up the function generator to the Input of the circuit to test which bin the 660Hz signal would fall in. <br>
              We used the following code, modified from Team Alpha, to collect values: </p>
              <!-- HTML generated using hilite.me --><div style="background: #ffffff; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%">void setup() {
  Serial<span style="color: #333333">.</span>begin(<span style="color: #0000DD; font-weight: bold">115200</span>); <span style="color: #333333">//</span> use the serial port
}

void loop() {
  <span style="color: #008800; font-weight: bold">while</span>(<span style="color: #0000DD; font-weight: bold">1</span>) {
    cli();
    <span style="color: #008800; font-weight: bold">for</span> (<span style="color: #007020">int</span> i <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">0</span> ; i <span style="color: #333333">&lt;</span> <span style="color: #0000DD; font-weight: bold">512</span> ; i <span style="color: #333333">+=</span> <span style="color: #0000DD; font-weight: bold">2</span>) {
      fft_input[i] <span style="color: #333333">=</span> analogRead(A1);
      fft_input[i<span style="color: #333333">+</span><span style="color: #0000DD; font-weight: bold">1</span>] <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">0</span>;
    }
    fft_window();
    fft_reorder();
    fft_run();
    fft_mag_log();
    sei();
    Serial<span style="color: #333333">.</span>println(<span style="background-color: #fff0f0">&quot;start&quot;</span>);
    <span style="color: #008800; font-weight: bold">for</span> (byte i <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">0</span> ; i <span style="color: #333333">&lt;</span> FFT_N<span style="color: #333333">/</span><span style="color: #0000DD; font-weight: bold">2</span> ; i<span style="color: #333333">++</span>) {
      Serial<span style="color: #333333">.</span>println(fft_log_out[i]);
    }
  }
}
</pre></div>

              <img class="img-fluid d-block mx-auto" width="650" height="100" src="./img/lab2/acoustic/660,500,750 with axis labels.PNG" alt="">
              <p>The 660Hz input from the function generator peaked at bin 20, whereas the 500Hz signal peaked at bin 15 and the 750Hz signal peaked at bin 22. This shows that the circuit can decipher between signals that are close together. <br>
              We also see peaks at bins 1 and 2 for all signals, due to DC values at the input. Since these are consistent for all frequencies, we can ignore these peaks. </p>

              <img class="img-fluid d-block mx-auto" width="650" height="100" src="./img/lab2/acoustic/microphone amplifier schematic.png" alt="">
              <p> We then added the above amplifier circuit, from Team Alpha, as recommended by the TA’s. <br>
              The exact resistor values are: 328Ω, 3.24kΩ, 391kΩ, 9.85kΩ, 9.8kΩ </p>

              <img class="img-fluid d-block mx-auto" width="650" height="100" src="./img/lab2/acoustic/with and without amp with axis labels.png" alt="">
              <p> We then tested the microphone with a 660Hz tone being played, instead of directly inputting a signal from the function generator. We collected the values using the same code as before. As seen in the graph above, without the amplifier the 660Hz tone blends in with the other signals. With the amplifier connected, we can see a peak at bin 20, which is where we saw the 660Hz peak with the function generator. There are also peaks at bin 39 and 58, most likely due to background noise in the lab. This shows that the circuit is successful in amplifying the 660Hz value above noise, and can identify the 660Hz tone based on which bin it appears in (bin 20).
              </p>




        
    <!-- Footer -->
    <footer>
      <div class="container">
        <div class="row">
          <div class="col-md-4">
            <span class="copyright">Copyright &copy; 2018 ECE 3400 Team 26</span>
          </div>
          <!--<div class="col-md-4">
            <ul class="list-inline social-buttons">
              <li class="list-inline-item">
                <a href="#">
                  <i class="fab fa-twitter"></i>
                </a>
              </li>
              <li class="list-inline-item">
                <a href="#">
                  <i class="fab fa-facebook-f"></i>
                </a>
              </li>
              <li class="list-inline-item">
                <a href="#">
                  <i class="fab fa-linkedin-in"></i>
                </a>
              </li>
            </ul>
          </div>
          <div class="col-md-4">
            <ul class="list-inline quicklinks">
              <li class="list-inline-item">
                <a href="#">Privacy Policy</a>
              </li>
              <li class="list-inline-item">
                <a href="#">Terms of Use</a>
              </li>
            </ul>
        </div>-->
        </div>
      </div>
    </footer>



    <!-- Bootstrap core JavaScript -->
    <script src="vendor/jquery/jquery.min.js"></script>
    <script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

    <!-- Plugin JavaScript -->
    <script src="vendor/jquery-easing/jquery.easing.min.js"></script>

    <!-- Contact form JavaScript -->
    <script src="js/jqBootstrapValidation.js"></script>
    <script src="js/contact_me.js"></script>

    <!-- Custom scripts for this template -->
    <script src="js/agency.min.js"></script>

  </body>

</html>
